// Copyright 2025-2026 Oliver Eikemeier. All Rights Reserved.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
//
// SPDX-License-Identifier: Apache-2.0

package conservative

import "fmt"

func foo() {
	x := 1
	// want "Variable 'a' can be moved to tighter block scope"
	b := "abc"[x]
	if x++; x > 0 {
		a := 1
		fmt.Println(a, b)
	}
}

func bar() {
	var x int
	incX := func() { x++ }
	x, ok := 1, true
	incX()
	if ok {
		fmt.Println(x)
	}
}

func baz() {
	got := "got"
	want := "want"
	if got == want {
		fmt.Println(got, want)
	}
}

func safe() {
	// want "Variable 'x' can be moved to tighter if scope"
	const c = 2

	{
		type T int
	}
	if x := 1; x > 0 {
		var v string = "1" // want "Variable 'v' can be moved to tighter block scope"

		fmt.Println(c, v)
	}
}

func unsafeVar() {
	x := 0
	incX := func() int { x++; return x }

	x, y := 0, 1
	var _ int = incX()
	if x > 0 {
		fmt.Println(y)
	}
}

func labeledStatement() {
	x := 0
	incX := func() { x++ }

label:
	x, y := 0, 1
	incX()
	if x == 0 {
		fmt.Println(x, y)
		goto label
	}
}

func wraped() {
	if true {
		// want "Variables 'a' and 'b' can be moved to tighter if scope"

		if a, b := true, true; a {
			if b {
			}
		}
	}
}
